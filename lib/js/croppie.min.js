!function(a,b){"function"==typeof define&&define.amd?define(["exports"],b):b("object"==typeof exports&&"string"!=typeof exports.nodeName?exports:a.commonJsStrict={})}(this,function(a){function b(a){if(a in U)return a;for(var b=a[0].toUpperCase()+a.slice(1),c=T.length;c--;)if(a=T[c]+b,a in U)return a}function c(a,b){a=a||{};for(var d in b)b[d]&&b[d].constructor&&b[d].constructor===Object?(a[d]=a[d]||{},c(a[d],b[d])):a[d]=b[d];return a}function d(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}}function e(a){if("createEvent"in document){var b=document.createEvent("HTMLEvents");b.initEvent("change",!1,!0),a.dispatchEvent(b)}else a.fireEvent("onchange")}function f(a,b,c){if("string"==typeof b){var d=b;b={},b[d]=c}for(var e in b)a.style[e]=b[e]}function g(a,b){a.classList?a.classList.add(b):a.className+=" "+b}function h(a,b){a.classList?a.classList.remove(b):a.className=a.className.replace(b,"")}function i(a){return parseInt(a,10)}function j(a,b,c){var d=b||new Image;return d.style.opacity=0,new Promise(function(b){function e(){setTimeout(function(){b(d)},1)}return d.src===a?void e():(d.exifdata=null,d.removeAttribute("crossOrigin"),a.match(/^https?:\/\/|^\/\//)&&d.setAttribute("crossOrigin","anonymous"),d.onload=function(){c?EXIF.getData(d,function(){e()}):e()},void(d.src=a))})}function k(a){var b=a.naturalWidth,c=a.naturalHeight;if(a.exifdata&&a.exifdata.Orientation>=5){var d=b;b=c,c=d}return{width:b,height:c}}function l(a){return a.exifdata.Orientation}function m(a,b,c){var d=b.width,e=b.height,f=a.getContext("2d");switch(a.width=b.width,a.height=b.height,f.save(),c){case 2:f.translate(d,0),f.scale(-1,1);break;case 3:f.translate(d,e),f.rotate(180*Math.PI/180);break;case 4:f.translate(0,e),f.scale(1,-1);break;case 5:a.width=e,a.height=d,f.rotate(90*Math.PI/180),f.scale(1,-1);break;case 6:a.width=e,a.height=d,f.rotate(90*Math.PI/180),f.translate(0,-e);break;case 7:a.width=e,a.height=d,f.rotate(-90*Math.PI/180),f.translate(-d,e),f.scale(1,-1);break;case 8:a.width=e,a.height=d,f.translate(0,d),f.rotate(-90*Math.PI/180)}f.drawImage(b,0,0,d,e),f.restore()}function n(){var a,b,c,d,e,h,i=this,j="croppie-container",k=i.options.viewport.type?"cr-vp-"+i.options.viewport.type:null;i.options.useCanvas=i.options.enableOrientation||o.call(i),i.data={},i.elements={},a=i.elements.boundary=document.createElement("div"),c=i.elements.viewport=document.createElement("div"),b=i.elements.img=document.createElement("img"),d=i.elements.overlay=document.createElement("div"),i.options.useCanvas?(i.elements.canvas=document.createElement("canvas"),i.elements.preview=i.elements.canvas):i.elements.preview=i.elements.img,g(a,"cr-boundary"),e=i.options.boundary.width,h=i.options.boundary.height,f(a,{width:e+(isNaN(e)?"":"px"),height:h+(isNaN(h)?"":"px")}),g(c,"cr-viewport"),k&&g(c,k),f(c,{width:i.options.viewport.width+"px",height:i.options.viewport.height+"px"}),c.setAttribute("tabindex",0),g(i.elements.preview,"cr-image"),g(d,"cr-overlay"),i.element.appendChild(a),a.appendChild(i.elements.preview),a.appendChild(c),a.appendChild(d),g(i.element,j),i.options.customClass&&g(i.element,i.options.customClass),v.call(this),i.options.enableZoom&&r.call(i),i.options.enableResize&&p.call(i)}function o(){return this.options.enableExif&&window.EXIF}function p(){function a(a){if((void 0===a.button||0===a.button)&&(a.preventDefault(),!o)){var f=m.elements.overlay.getBoundingClientRect();if(o=!0,e=a.pageX,h=a.pageY,d=-1!==a.currentTarget.className.indexOf("vertical")?"v":"h",i=f.width,j=f.height,a.touches){var g=a.touches[0];e=g.pageX,h=g.pageY}window.addEventListener("mousemove",b),window.addEventListener("touchmove",b),window.addEventListener("mouseup",c),window.addEventListener("touchend",c),document.body.style[S]="none"}}function b(a){var b=a.pageX,c=a.pageY;if(a.preventDefault(),a.touches){var g=a.touches[0];b=g.pageX,c=g.pageY}var k=b-e,l=c-h,o=m.options.viewport.height+l,q=m.options.viewport.width+k;"v"===d&&o>=p&&j>=o?(f(n,{height:o+"px"}),m.options.boundary.height+=l,f(m.elements.boundary,{height:m.options.boundary.height+"px"}),m.options.viewport.height+=l,f(m.elements.viewport,{height:m.options.viewport.height+"px"})):"h"===d&&q>=p&&i>=q&&(f(n,{width:q+"px"}),m.options.boundary.width+=k,f(m.elements.boundary,{width:m.options.boundary.width+"px"}),m.options.viewport.width+=k,f(m.elements.viewport,{width:m.options.viewport.width+"px"})),w.call(m),A.call(m),u.call(m),x.call(m),h=c,e=b}function c(){o=!1,window.removeEventListener("mousemove",b),window.removeEventListener("touchmove",b),window.removeEventListener("mouseup",c),window.removeEventListener("touchend",c),document.body.style[S]=""}var d,e,h,i,j,k,l,m=this,n=document.createElement("div"),o=!1,p=50;g(n,"cr-resizer"),f(n,{width:this.options.viewport.width+"px",height:this.options.viewport.height+"px"}),this.options.resizeControls.height&&(k=document.createElement("div"),g(k,"cr-resizer-vertical"),n.appendChild(k)),this.options.resizeControls.width&&(l=document.createElement("div"),g(l,"cr-resizer-horisontal"),n.appendChild(l)),k&&k.addEventListener("mousedown",a),l&&l.addEventListener("mousedown",a),this.elements.boundary.appendChild(n)}function q(a){if(this.options.enableZoom){var b=this.elements.zoomer,c=J(a,4);b.value=Math.max(b.min,Math.min(b.max,c))}}function r(){function a(){s.call(c,{value:parseFloat(e.value),origin:new X(c.elements.preview),viewportRect:c.elements.viewport.getBoundingClientRect(),transform:W.parse(c.elements.preview)})}function b(b){var d,e;d=b.wheelDelta?b.wheelDelta/1200:b.deltaY?b.deltaY/1060:b.detail?b.detail/-60:0,e=c._currentZoom+d*c._currentZoom,b.preventDefault(),q.call(c,e),a.call(c)}var c=this,d=c.elements.zoomerWrap=document.createElement("div"),e=c.elements.zoomer=document.createElement("input");g(d,"cr-slider-wrap"),g(e,"cr-slider"),e.type="range",e.step="0.0001",e.value=1,e.style.display=c.options.showZoomer?"":"none",c.element.appendChild(d),d.appendChild(e),c._currentZoom=1,c.elements.zoomer.addEventListener("input",a),c.elements.zoomer.addEventListener("change",a),c.options.mouseWheelZoom&&(c.elements.boundary.addEventListener("mousewheel",b),c.elements.boundary.addEventListener("DOMMouseScroll",b))}function s(a){function b(){var a={};a[R]=d.toString(),a[Q]=g.toString(),f(c.elements.preview,a)}var c=this,d=a?a.transform:W.parse(c.elements.preview),e=a?a.viewportRect:c.elements.viewport.getBoundingClientRect(),g=a?a.origin:new X(c.elements.preview);if(c._currentZoom=a?a.value:c._currentZoom,d.scale=c._currentZoom,b(),c.options.enforceBoundary){var h=t.call(c,e),i=h.translate,j=h.origin;d.x>=i.maxX&&(g.x=j.minX,d.x=i.maxX),d.x<=i.minX&&(g.x=j.maxX,d.x=i.minX),d.y>=i.maxY&&(g.y=j.minY,d.y=i.maxY),d.y<=i.minY&&(g.y=j.maxY,d.y=i.minY)}b(),Y.call(c),x.call(c)}function t(a){var b=this,c=b._currentZoom,d=a.width,e=a.height,f=b.elements.boundary.clientWidth/2,g=b.elements.boundary.clientHeight/2,h=b.elements.preview.getBoundingClientRect(),i=h.width,j=h.height,k=d/2,l=e/2,m=-1*(k/c-f),n=m-(i*(1/c)-d*(1/c)),o=-1*(l/c-g),p=o-(j*(1/c)-e*(1/c)),q=1/c*k,r=i*(1/c)-q,s=1/c*l,t=j*(1/c)-s;return{translate:{maxX:m,minX:n,maxY:o,minY:p},origin:{maxX:r,minX:q,maxY:t,minY:s}}}function u(){var a=this,b=a._currentZoom,c=a.elements.preview.getBoundingClientRect(),d=a.elements.viewport.getBoundingClientRect(),e=W.parse(a.elements.preview.style[R]),g=new X(a.elements.preview),h=d.top-c.top+d.height/2,i=d.left-c.left+d.width/2,j={},k={};j.y=h/b,j.x=i/b,k.y=(j.y-g.y)*(1-b),k.x=(j.x-g.x)*(1-b),e.x-=k.x,e.y-=k.y;var l={};l[Q]=j.x+"px "+j.y+"px",l[R]=e.toString(),f(a.elements.preview,l)}function v(){function a(a,b){var c=n.elements.preview.getBoundingClientRect(),d=m.y+b,e=m.x+a;n.options.enforceBoundary?(l.top>c.top+b&&l.bottom<c.bottom+b&&(m.y=d),l.left>c.left+a&&l.right<c.right+a&&(m.x=e)):(m.y=d,m.x=e)}function b(a){function b(a){switch(a){case d:return[1,0];case e:return[0,1];case f:return[-1,0];case g:return[0,-1]}}var d=37,e=38,f=39,g=40;if(!a.shiftKey||a.keyCode!=e&&a.keyCode!=g){if(n.options.enableKeyMovement&&a.keyCode>=37&&a.keyCode<=40){a.preventDefault();var h=b(a.keyCode);m=W.parse(n.elements.preview),document.body.style[S]="none",l=n.elements.viewport.getBoundingClientRect(),c(h)}}else{var i=0;i=a.keyCode==e?parseFloat(n.elements.zoomer.value,10)+parseFloat(n.elements.zoomer.step,10):parseFloat(n.elements.zoomer.value,10)-parseFloat(n.elements.zoomer.step,10),n.setZoom(i)}}function c(b){var c=b[0],d=b[1],e={};a(c,d),e[R]=m.toString(),f(n.elements.preview,e),w.call(n),document.body.style[S]="",u.call(n),x.call(n),k=0}function d(a){if((void 0===a.button||0===a.button)&&(a.preventDefault(),!o)){if(o=!0,i=a.pageX,j=a.pageY,a.touches){var b=a.touches[0];i=b.pageX,j=b.pageY}m=W.parse(n.elements.preview),window.addEventListener("mousemove",g),window.addEventListener("touchmove",g),window.addEventListener("mouseup",h),window.addEventListener("touchend",h),document.body.style[S]="none",l=n.elements.viewport.getBoundingClientRect()}}function g(b){b.preventDefault();var c=b.pageX,d=b.pageY;if(b.touches){var g=b.touches[0];c=g.pageX,d=g.pageY}var h=c-i,l=d-j,o={};if("touchmove"==b.type&&b.touches.length>1){var p=b.touches[0],r=b.touches[1],s=Math.sqrt((p.pageX-r.pageX)*(p.pageX-r.pageX)+(p.pageY-r.pageY)*(p.pageY-r.pageY));k||(k=s/n._currentZoom);var t=s/k;return q.call(n,t),void e(n.elements.zoomer)}a(h,l),o[R]=m.toString(),f(n.elements.preview,o),w.call(n),j=d,i=c}function h(){o=!1,window.removeEventListener("mousemove",g),window.removeEventListener("touchmove",g),window.removeEventListener("mouseup",h),window.removeEventListener("touchend",h),document.body.style[S]="",u.call(n),x.call(n),k=0}var i,j,k,l,m,n=this,o=!1;n.elements.overlay.addEventListener("mousedown",d),n.elements.viewport.addEventListener("keydown",b),n.elements.overlay.addEventListener("touchstart",d)}function w(){var a=this,b=a.elements.boundary.getBoundingClientRect(),c=a.elements.preview.getBoundingClientRect();f(a.elements.overlay,{width:c.width+"px",height:c.height+"px",top:c.top-b.top+"px",left:c.left-b.left+"px"})}function x(){var a,b=this,c=b.get();if(y.call(b))if(b.options.update.call(b,c),b.$&&"undefined"==typeof Prototype)b.$(b.element).trigger("update",c);else{var a;window.CustomEvent?a=new CustomEvent("update",{detail:c}):(a=document.createEvent("CustomEvent"),a.initCustomEvent("update",!0,!0,c)),b.element.dispatchEvent(a)}}function y(){return this.elements.preview.offsetHeight>0&&this.elements.preview.offsetWidth>0}function z(){var a=this,b=1,c={},d=a.elements.preview,e=a.elements.preview.getBoundingClientRect(),g=new W(0,0,b),h=new X,i=y.call(a);i&&!a.data.bound&&(a.data.bound=!0,c[R]=g.toString(),c[Q]=h.toString(),c.opacity=1,f(d,c),a._originalImageWidth=e.width,a._originalImageHeight=e.height,a.options.enableZoom?A.call(a,!0):a._currentZoom=b,g.scale=a._currentZoom,c[R]=g.toString(),f(d,c),a.data.points.length?B.call(a,a.data.points):C.call(a),u.call(a),w.call(a))}function A(a){var b,c,d,f,g=this,h=0,i=1.5,j=g.elements.zoomer,k=parseFloat(j.value),l=g.elements.boundary.getBoundingClientRect(),m=g.elements.preview.getBoundingClientRect(),n=g.elements.viewport.getBoundingClientRect();g.options.enforceBoundary&&(d=n.width/(a?m.width:m.width/k),f=n.height/(a?m.height:m.height/k),h=Math.max(d,f)),h>=i&&(i=h+1),j.min=J(h,4),j.max=J(i,4),a&&(c=Math.max(l.width/m.width,l.height/m.height),b=null!==g.data.boundZoom?g.data.boundZoom:c,q.call(g,b)),e(j)}function B(a){if(4!=a.length)throw"Croppie - Invalid number of points supplied: "+a;var b=this,c=a[2]-a[0],d=b.elements.viewport.getBoundingClientRect(),e=b.elements.boundary.getBoundingClientRect(),g={left:d.left-e.left,top:d.top-e.top},h=d.width/c,i=a[1],j=a[0],k=-1*a[1]+g.top,l=-1*a[0]+g.left,m={};m[Q]=j+"px "+i+"px",m[R]=new W(l,k,h).toString(),f(b.elements.preview,m),q.call(b,h),b._currentZoom=h}function C(){var a=this,b=a.elements.preview.getBoundingClientRect(),c=a.elements.viewport.getBoundingClientRect(),d=a.elements.boundary.getBoundingClientRect(),e=c.left-d.left,g=c.top-d.top,h=e-(b.width-c.width)/2,i=g-(b.height-c.height)/2,j=new W(h,i,a._currentZoom);f(a.elements.preview,R,j.toString())}function D(a){var b=this,c=b.elements.canvas,d=b.elements.img,e=c.getContext("2d"),f=o.call(b),a=b.options.enableOrientation&&a;if(e.clearRect(0,0,c.width,c.height),c.width=d.width,c.height=d.height,f&&!a){var g=l(d);m(c,d,i(g||0,10))}else a&&m(c,d,a)}function E(a){var b=this,c=a.points,d=i(c[0]),e=i(c[1]),f=i(c[2]),g=i(c[3]),h=f-d,j=g-e,k=a.circle,l=document.createElement("canvas"),m=l.getContext("2d"),n=h,o=j,p=0,q=0,r=n,s=o,t=a.outputWidth&&a.outputHeight,u=1;return t&&(r=a.outputWidth,s=a.outputHeight,u=r/n),l.width=r,l.height=s,a.backgroundColor&&(m.fillStyle=a.backgroundColor,m.fillRect(0,0,n,o)),b.options.enforceBoundary||(0>d&&(p=Math.abs(d),d=0),0>e&&(q=Math.abs(e),e=0),f>b._originalImageWidth&&(h=b._originalImageWidth-d,n=h),g>b._originalImageHeight&&(j=b._originalImageHeight-e,o=j)),1!==u&&(p*=u,q*=u,n*=u,o*=u),m.drawImage(this.elements.preview,d,e,Math.min(h,b._originalImageWidth),Math.min(j,b._originalImageHeight),p,q,n,o),k&&(m.fillStyle="#fff",m.globalCompositeOperation="destination-in",m.beginPath(),m.arc(n/2,o/2,n/2,0,2*Math.PI,!0),m.closePath(),m.fill()),l}function F(a){var b=a.points,c=document.createElement("div"),d=document.createElement("img"),e=b[2]-b[0],h=b[3]-b[1];return g(c,"croppie-result"),c.appendChild(d),f(d,{left:-1*b[0]+"px",top:-1*b[1]+"px"}),d.src=a.url,f(c,{width:e+"px",height:h+"px"}),c}function G(a){return E.call(this,a).toDataURL(a.format,a.quality)}function H(a){var b=this;return new Promise(function(c){E.call(b,a).toBlob(function(a){c(a)},a.format,a.quality)})}function I(a,b){var c,d=this,e=[],f=null,g=o.call(d);if("string"==typeof a)c=a,a={};else if(Array.isArray(a))e=a.slice();else{if("undefined"==typeof a&&d.data.url)return z.call(d),x.call(d),null;c=a.url,e=a.points||[],f="undefined"==typeof a.zoom?null:a.zoom}return d.data.bound=!1,d.data.url=c||d.data.url,d.data.boundZoom=f,j(c,d.elements.img,g).then(function(c){if(e.length)d.options.relative&&(e=[e[0]*c.naturalWidth/100,e[1]*c.naturalHeight/100,e[2]*c.naturalWidth/100,e[3]*c.naturalHeight/100]);else{var f,g,h=k(c),i=d.elements.viewport.getBoundingClientRect(),j=i.width/i.height,l=h.width/h.height;l>j?(g=h.height,f=g*j):(f=h.width,g=f/j);var m=(h.width-f)/2,n=(h.height-g)/2,o=m+f,p=n+g;d.data.points=[m,n,o,p]}d.data.points=e.map(function(a){return parseFloat(a)}),d.options.useCanvas&&D.call(d,a.orientation||1),z.call(d),x.call(d),b&&b()})}function J(a,b){return parseFloat(a).toFixed(b||0)}function K(){var a=this,b=a.elements.preview.getBoundingClientRect(),c=a.elements.viewport.getBoundingClientRect(),d=c.left-b.left,e=c.top-b.top,f=(c.width-a.elements.viewport.offsetWidth)/2,g=(c.height-a.elements.viewport.offsetHeight)/2,h=d+a.elements.viewport.offsetWidth+f,i=e+a.elements.viewport.offsetHeight+g,j=a._currentZoom;(j===1/0||isNaN(j))&&(j=1);var k=a.options.enforceBoundary?0:Number.NEGATIVE_INFINITY;return d=Math.max(k,d/j),e=Math.max(k,e/j),h=Math.max(k,h/j),i=Math.max(k,i/j),{points:[J(d),J(e),J(h),J(i)],zoom:j}}function L(a){var b,d=this,e=K.call(d),f=c(Z,c({},a)),g="string"==typeof a?a:f.type||"base64",h=f.size||"viewport",i=f.format,j=f.quality,k=f.backgroundColor,l="boolean"==typeof f.circle?f.circle:"circle"===d.options.viewport.type,m=d.elements.viewport.getBoundingClientRect(),n=m.width/m.height;return"viewport"===h?(e.outputWidth=m.width,e.outputHeight=m.height):"object"==typeof h&&(h.width&&h.height?(e.outputWidth=h.width,e.outputHeight=h.height):h.width?(e.outputWidth=h.width,e.outputHeight=h.width/n):h.height&&(e.outputWidth=h.height*n,e.outputHeight=h.height)),$.indexOf(i)>-1&&(e.format="image/"+i,e.quality=j),e.circle=l,e.url=d.data.url,e.backgroundColor=k,b=new Promise(function(a){switch(g.toLowerCase()){case"rawcanvas":a(E.call(d,e));break;case"canvas":case"base64":a(G.call(d,e));break;case"blob":H.call(d,e).then(a);break;default:a(F.call(d,e))}})}function M(){z.call(this)}function N(a){if(!this.options.useCanvas)throw"Croppie: Cannot rotate without enableOrientation";var b=this,c=b.elements.canvas,d=document.createElement("canvas"),e=1;d.width=c.width,d.height=c.height;var f=d.getContext("2d");f.drawImage(c,0,0),(90===a||-270===a)&&(e=6),(-90===a||270===a)&&(e=8),(180===a||-180===a)&&(e=3),m(c,d,e),s.call(b),d=null}function O(){var a=this;a.element.removeChild(a.elements.boundary),h(a.element,"croppie-container"),a.options.enableZoom&&a.element.removeChild(a.elements.zoomerWrap),delete a.elements}function P(a,b){if(this.element=a,this.options=c(c({},P.defaults),b),"img"===this.element.tagName.toLowerCase()){var d=this.element;g(d,"cr-original-image");var e=document.createElement("div");this.element.parentNode.appendChild(e),e.appendChild(d),this.element=e,this.options.url=this.options.url||d.src}if(n.call(this),this.options.url){var f={url:this.options.url,points:this.options.points};delete this.options.url,delete this.options.points,I.call(this,f)}}"function"!=typeof Promise&&!function(a){function b(a,b){return function(){a.apply(b,arguments)}}function c(a){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof a)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],i(a,b(e,this),b(f,this))}function d(a){var b=this;return null===this._state?void this._deferreds.push(a):void k(function(){var c=b._state?a.onFulfilled:a.onRejected;if(null===c)return void(b._state?a.resolve:a.reject)(b._value);var d;try{d=c(b._value)}catch(e){return void a.reject(e)}a.resolve(d)})}function e(a){try{if(a===this)throw new TypeError("A promise cannot be resolved with itself.");if(a&&("object"==typeof a||"function"==typeof a)){var c=a.then;if("function"==typeof c)return void i(b(c,a),b(e,this),b(f,this))}this._state=!0,this._value=a,g.call(this)}catch(d){f.call(this,d)}}function f(a){this._state=!1,this._value=a,g.call(this)}function g(){for(var a=0,b=this._deferreds.length;b>a;a++)d.call(this,this._deferreds[a]);this._deferreds=null}function h(a,b,c,d){this.onFulfilled="function"==typeof a?a:null,this.onRejected="function"==typeof b?b:null,this.resolve=c,this.reject=d}function i(a,b,c){var d=!1;try{a(function(a){d||(d=!0,b(a))},function(a){d||(d=!0,c(a))})}catch(e){if(d)return;d=!0,c(e)}}var j=setTimeout,k="function"==typeof setImmediate&&setImmediate||function(a){j(a,1)},l=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)};c.prototype["catch"]=function(a){return this.then(null,a)},c.prototype.then=function(a,b){var e=this;return new c(function(c,f){d.call(e,new h(a,b,c,f))})},c.all=function(){var a=Array.prototype.slice.call(1===arguments.length&&l(arguments[0])?arguments[0]:arguments);return new c(function(b,c){function d(f,g){try{if(g&&("object"==typeof g||"function"==typeof g)){var h=g.then;if("function"==typeof h)return void h.call(g,function(a){d(f,a)},c)}a[f]=g,0===--e&&b(a)}catch(i){c(i)}}if(0===a.length)return b([]);for(var e=a.length,f=0;f<a.length;f++)d(f,a[f])})},c.resolve=function(a){return a&&"object"==typeof a&&a.constructor===c?a:new c(function(b){b(a)})},c.reject=function(a){return new c(function(b,c){c(a)})},c.race=function(a){return new c(function(b,c){for(var d=0,e=a.length;e>d;d++)a[d].then(b,c)})},c._setImmediateFn=function(a){k=a},"undefined"!=typeof module&&module.exports?module.exports=c:a.Promise||(a.Promise=c)}(this),"function"!=typeof window.CustomEvent&&!function(){function a(a,b){b=b||{bubbles:!1,cancelable:!1,detail:void 0};var c=document.createEvent("CustomEvent");return c.initCustomEvent(a,b.bubbles,b.cancelable,b.detail),c}a.prototype=window.Event.prototype,window.CustomEvent=a}(),HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(a,b,c){for(var d=atob(this.toDataURL(b,c).split(",")[1]),e=d.length,f=new Uint8Array(e),g=0;e>g;g++)f[g]=d.charCodeAt(g);a(new Blob([f],{type:b||"image/png"}))}});var Q,R,S,T=["Webkit","Moz","ms"],U=document.createElement("div").style;R=b("transform"),Q=b("transformOrigin"),S=b("userSelect");var V={translate3d:{suffix:", 0px"},translate:{suffix:""}},W=function(a,b,c){this.x=parseFloat(a),this.y=parseFloat(b),this.scale=parseFloat(c)};W.parse=function(a){return a.style?W.parse(a.style[R]):a.indexOf("matrix")>-1||a.indexOf("none")>-1?W.fromMatrix(a):W.fromString(a)},W.fromMatrix=function(a){var b=a.substring(7).split(",");return b.length&&"none"!==a||(b=[1,0,0,1,0,0]),new W(i(b[4]),i(b[5]),parseFloat(b[0]))},W.fromString=function(a){var b=a.split(") "),c=b[0].substring(P.globals.translate.length+1).split(","),d=b.length>1?b[1].substring(6):1,e=c.length>1?c[0]:0,f=c.length>1?c[1]:0;return new W(e,f,d)},W.prototype.toString=function(){var a=V[P.globals.translate].suffix||"";return P.globals.translate+"("+this.x+"px, "+this.y+"px"+a+") scale("+this.scale+")"};var X=function(a){if(!a||!a.style[Q])return this.x=0,void(this.y=0);var b=a.style[Q].split(" ");this.x=parseFloat(b[0]),this.y=parseFloat(b[1])};X.prototype.toString=function(){return this.x+"px "+this.y+"px"};var Y=d(w,500),Z={type:"canvas",format:"png",quality:1},$=["jpeg","webp","png"];if(window.jQuery){var _=window.jQuery;_.fn.croppie=function(a){var b=typeof a;if("string"===b){var c=Array.prototype.slice.call(arguments,1),d=_(this).data("croppie");return"get"===a?d.get():"result"===a?d.result.apply(d,c):"bind"===a?d.bind.apply(d,c):this.each(function(){var b=_(this).data("croppie");if(b){var d=b[a];if(!_.isFunction(d))throw"Croppie "+a+" method not found";d.apply(b,c),"destroy"===a&&_(this).removeData("croppie")}})}return this.each(function(){var b=new P(this,a);b.$=_,_(this).data("croppie",b)})}}P.defaults={viewport:{width:100,height:100,type:"square"},boundary:{},orientationControls:{enabled:!0,leftClass:"",rightClass:""},resizeControls:{width:!0,height:!0},customClass:"",showZoomer:!0,enableZoom:!0,enableResize:!1,mouseWheelZoom:!0,enableExif:!1,enforceBoundary:!0,enableOrientation:!1,enableKeyMovement:!0,update:function(){}},P.globals={translate:"translate3d"},c(P.prototype,{bind:function(a,b){return I.call(this,a,b)},get:function(){var a=K.call(this),b=a.points;return this.options.relative&&(b[0]/=this.elements.img.naturalWidth/100,b[1]/=this.elements.img.naturalHeight/100,b[2]/=this.elements.img.naturalWidth/100,b[3]/=this.elements.img.naturalHeight/100),a},result:function(a){return L.call(this,a)},refresh:function(){return M.call(this)},setZoom:function(a){q.call(this,a),e(this.elements.zoomer)},rotate:function(a){N.call(this,a)},destroy:function(){return O.call(this)}}),a.Croppie=window.Croppie=P,"object"==typeof module&&module.exports&&(module.exports=P)});